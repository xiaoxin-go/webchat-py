{"version":3,"sources":["webpack:///src/components/wap/User.vue","webpack:///./src/components/wap/User.vue?0cf7","webpack:///./src/components/wap/User.vue"],"names":["User","name","mounted","this","user","$User","data","chatroom_active","update_nickname_modal","new_nickname","methods","clickImage","document","getElementById","click","uploadImage","_this","asyncToGenerator_default","regenerator_default","a","mark","_callee","input","file","formData","resp","wrap","_context","prev","next","files","FormData","append","Object","api","sent","console","log","code","logo","$Server","url","updateUserLogo","$Message","error","message","stop","_this2","_callee2","json_data","_context2","setUser","updateUserNickname","_this3","_callee3","_context3","trim","warning","abrupt","nickname","Logout","_this4","_callee4","_context4","success","$router","push","sockets","connect","val","filters","watch","wap_User","render","_vm","_h","$createElement","_c","_self","staticClass","on","$event","staticStyle","display","attrs","type","id","change","_v","src","alt","_s","username","margin-top","size","long","title","class-name","on-cancel","model","value","callback","$$v","expression","placeholder","autofocus","slot","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/6.e6b3465a1400c61bed64.js","sourcesContent":["<template>\n  <div class=\"wap-main-body\" @click=\"chatroom_active=false\">\n        <input type=\"file\" id=\"send-image\" style=\"display: none;\" @change=\"uploadImage\">\n        <!------------------  个人设置页面  ---------------->\n        <div class=\"wap-main-body-setting\">\n          <div class=\"wap-main-friend-body\">\n            <div class=\"wap-main-friend-logo\">\n              <img :src=\"user.logo\" alt=\"\">\n            </div>\n            <div class=\"wap-main-friend-info\">\n              <p class=\"wap-main-friend-remark\">{{user.username}}</p>\n              <p class=\"wap-main-friend-nickname\">昵称：{{user.nickname}} <Icon type=\"md-create\" alt=\"修改昵称\" @click=\"update_nickname_modal=true\"/></p>\n              <Button style=\"margin-top: 10px;\" @click=\"clickImage\" size=\"small\">更换头像</Button>\n            </div>\n          </div>\n          <div class=\"wap-main-friend-bottom\">\n            <div class=\"wap-main-friend-update-remark\" @click=\"$router.push('/user_password')\">修改密码</div>\n            <div class=\"wap-main-friend-sendmessage\" @click=\"\">清空站点聊天记录</div>\n            <div class=\"wap-main-friend-delete\"><Button long type=\"error\" @click=\"Logout\">退出站点</Button></div>\n          </div>\n        </div>\n\n        <!--  修改群名模态框 -->\n        <Modal\n          v-model=\"update_nickname_modal\"\n          @on-cancel=\"update_nickname_modal=false\"\n          title=\"修改群聊名称\"\n          class-name=\"wap-my-modal\">\n          <div class=\"wap-my-modal-text\">\n            <Input placeholder=\"请输入新昵称\" autofocus v-model=\"new_nickname\"/>\n          </div>\n          <div slot=\"footer\">\n            <Button type=\"text\" @click=\"update_nickname_modal=false\">取消</Button>\n            <Button type=\"primary\" @click=\"updateUserNickname\">确定</Button>\n          </div>\n        </Modal>\n      </div>\n</template>\n\n<script>\n  import {updateUser, uploadLogo, Logout} from '../../api/index.js'\n  import {checkLogin} from \"../../api/index\";\n  export default {\n    name: \"User\",\n    mounted() {\n      this.user = this.$User.user;\n    },\n    data() {\n      return {\n        chatroom_active: false,\n        update_nickname_modal: false,\n        new_nickname: '',\n        user: {}\n      }\n    },\n    methods: {\n      // 选择图片\n      clickImage(){\n        document.getElementById('send-image').click();\n      },\n\n      // 发送图片\n      async uploadImage(){\n        let input = document.getElementById('send-image');\n        let file = input.files[0];\n        let formData = new FormData();\n        formData.append('file', file);\n        let resp = await uploadLogo(formData);\n        console.log(resp);\n        if (resp.code === 200){\n          this.user.logo = this.$Server + resp.data.url;        // 返回的是头像路径\n          console.log('上传头像成功', this.user.logo);\n          this.updateUserLogo();\n        }else{\n          this.$Message.error(resp.message)\n        }\n      },\n\n      // 修改头像\n      async updateUserLogo(){\n        let json_data = {\n          logo: this.user.logo\n        };\n        let resp = await updateUser(json_data);\n        if(resp.code === 200){\n          console.log('更换头像成功', this.user);\n          this.$User.setUser(this.user);\n        }else{\n          this.$Message.error(resp.message);\n        }\n      },\n\n      // 修改昵称\n      async updateUserNickname(){\n        if(!this.new_nickname.trim()){this.$Message.warning('用户昵称不能为空'); return}\n        let json_data = {\n          nickname: this.new_nickname\n        };\n        let resp = await updateUser(json_data);\n        if(resp.code === 200){\n          this.user.nickname = this.new_nickname;\n          this.$User.setUser(this.user);\n          this.update_nickname_modal = false;\n        }else{\n          this.$Message.error(resp.message);\n        }\n      },\n\n      // 退出登录\n      async Logout(){\n        let resp = await Logout();\n        console.log(resp);\n        if(resp.code === 200){\n          this.$Message.success('用户退出登录成功');\n          this.$User.setUser(null);\n          this.$router.push('/login')\n        }else{\n          this.$Message.warning('用户退出登录异常');\n        }\n      },\n\n    },\n    sockets:{\n      connect: function(){\n        console.log('socket connected')\n      },\n      message: function(){\n        console.log('返回' + val)\n      }\n    },\n    filters: {\n    },\n    watch:{\n      // message_data(){\n      //   this.$nextTick(() => {\n      //     console.log('....');\n      //     var container = this.$el.querySelector(\"chat-body\");\n      //     container.scrollTop = container.scrollHeight;\n      // })\n      // }\n    }\n  }\n</script>\n\n<style>\n\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/wap/User.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"wap-main-body\",on:{\"click\":function($event){_vm.chatroom_active=false}}},[_c('input',{staticStyle:{\"display\":\"none\"},attrs:{\"type\":\"file\",\"id\":\"send-image\"},on:{\"change\":_vm.uploadImage}}),_vm._v(\" \"),_c('div',{staticClass:\"wap-main-body-setting\"},[_c('div',{staticClass:\"wap-main-friend-body\"},[_c('div',{staticClass:\"wap-main-friend-logo\"},[_c('img',{attrs:{\"src\":_vm.user.logo,\"alt\":\"\"}})]),_vm._v(\" \"),_c('div',{staticClass:\"wap-main-friend-info\"},[_c('p',{staticClass:\"wap-main-friend-remark\"},[_vm._v(_vm._s(_vm.user.username))]),_vm._v(\" \"),_c('p',{staticClass:\"wap-main-friend-nickname\"},[_vm._v(\"昵称：\"+_vm._s(_vm.user.nickname)+\" \"),_c('Icon',{attrs:{\"type\":\"md-create\",\"alt\":\"修改昵称\"},on:{\"click\":function($event){_vm.update_nickname_modal=true}}})],1),_vm._v(\" \"),_c('Button',{staticStyle:{\"margin-top\":\"10px\"},attrs:{\"size\":\"small\"},on:{\"click\":_vm.clickImage}},[_vm._v(\"更换头像\")])],1)]),_vm._v(\" \"),_c('div',{staticClass:\"wap-main-friend-bottom\"},[_c('div',{staticClass:\"wap-main-friend-update-remark\",on:{\"click\":function($event){_vm.$router.push('/user_password')}}},[_vm._v(\"修改密码\")]),_vm._v(\" \"),_c('div',{staticClass:\"wap-main-friend-sendmessage\",on:{\"click\":function($event){}}},[_vm._v(\"清空站点聊天记录\")]),_vm._v(\" \"),_c('div',{staticClass:\"wap-main-friend-delete\"},[_c('Button',{attrs:{\"long\":\"\",\"type\":\"error\"},on:{\"click\":_vm.Logout}},[_vm._v(\"退出站点\")])],1)])]),_vm._v(\" \"),_c('Modal',{attrs:{\"title\":\"修改群聊名称\",\"class-name\":\"wap-my-modal\"},on:{\"on-cancel\":function($event){_vm.update_nickname_modal=false}},model:{value:(_vm.update_nickname_modal),callback:function ($$v) {_vm.update_nickname_modal=$$v},expression:\"update_nickname_modal\"}},[_c('div',{staticClass:\"wap-my-modal-text\"},[_c('Input',{attrs:{\"placeholder\":\"请输入新昵称\",\"autofocus\":\"\"},model:{value:(_vm.new_nickname),callback:function ($$v) {_vm.new_nickname=$$v},expression:\"new_nickname\"}})],1),_vm._v(\" \"),_c('div',{attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('Button',{attrs:{\"type\":\"text\"},on:{\"click\":function($event){_vm.update_nickname_modal=false}}},[_vm._v(\"取消\")]),_vm._v(\" \"),_c('Button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.updateUserNickname}},[_vm._v(\"确定\")])],1)])],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-b8c2eaa2\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/wap/User.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-b8c2eaa2\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./User.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./User.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./User.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-b8c2eaa2\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./User.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/wap/User.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}