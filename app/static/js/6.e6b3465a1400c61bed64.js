webpackJsonp([6],{"9srz":function(e,n){},PiJF:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=t("Xxa5"),s=t.n(a),r=t("exGp"),c=t.n(r),o=t("gyMJ"),i={name:"User",mounted:function(){this.user=this.$User.user},data:function(){return{chatroom_active:!1,update_nickname_modal:!1,new_nickname:"",user:{}}},methods:{clickImage:function(){document.getElementById("send-image").click()},uploadImage:function(){var e=this;return c()(s.a.mark(function n(){var t,a,r,c;return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t=document.getElementById("send-image"),a=t.files[0],(r=new FormData).append("file",a),n.next=6,Object(o.y)(r);case 6:c=n.sent,console.log(c),200===c.code?(e.user.logo=e.$Server+c.data.url,console.log("上传头像成功",e.user.logo),e.updateUserLogo()):e.$Message.error(c.message);case 9:case"end":return n.stop()}},n,e)}))()},updateUserLogo:function(){var e=this;return c()(s.a.mark(function n(){var t,a;return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t={logo:e.user.logo},n.next=3,Object(o.w)(t);case 3:200===(a=n.sent).code?(console.log("更换头像成功",e.user),e.$User.setUser(e.user)):e.$Message.error(a.message);case 5:case"end":return n.stop()}},n,e)}))()},updateUserNickname:function(){var e=this;return c()(s.a.mark(function n(){var t,a;return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e.new_nickname.trim()){n.next=3;break}return e.$Message.warning("用户昵称不能为空"),n.abrupt("return");case 3:return t={nickname:e.new_nickname},n.next=6,Object(o.w)(t);case 6:200===(a=n.sent).code?(e.user.nickname=e.new_nickname,e.$User.setUser(e.user),e.update_nickname_modal=!1):e.$Message.error(a.message);case 8:case"end":return n.stop()}},n,e)}))()},Logout:function(){var e=this;return c()(s.a.mark(function n(){var t;return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(o.a)();case 2:t=n.sent,console.log(t),200===t.code?(e.$Message.success("用户退出登录成功"),e.$User.setUser(null),e.$router.push("/login")):e.$Message.warning("用户退出登录异常");case 5:case"end":return n.stop()}},n,e)}))()}},sockets:{connect:function(){console.log("socket connected")},message:function(){console.log("返回"+val)}},filters:{},watch:{}},u={render:function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"wap-main-body",on:{click:function(n){e.chatroom_active=!1}}},[t("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"send-image"},on:{change:e.uploadImage}}),e._v(" "),t("div",{staticClass:"wap-main-body-setting"},[t("div",{staticClass:"wap-main-friend-body"},[t("div",{staticClass:"wap-main-friend-logo"},[t("img",{attrs:{src:e.user.logo,alt:""}})]),e._v(" "),t("div",{staticClass:"wap-main-friend-info"},[t("p",{staticClass:"wap-main-friend-remark"},[e._v(e._s(e.user.username))]),e._v(" "),t("p",{staticClass:"wap-main-friend-nickname"},[e._v("昵称："+e._s(e.user.nickname)+" "),t("Icon",{attrs:{type:"md-create",alt:"修改昵称"},on:{click:function(n){e.update_nickname_modal=!0}}})],1),e._v(" "),t("Button",{staticStyle:{"margin-top":"10px"},attrs:{size:"small"},on:{click:e.clickImage}},[e._v("更换头像")])],1)]),e._v(" "),t("div",{staticClass:"wap-main-friend-bottom"},[t("div",{staticClass:"wap-main-friend-update-remark",on:{click:function(n){e.$router.push("/user_password")}}},[e._v("修改密码")]),e._v(" "),t("div",{staticClass:"wap-main-friend-sendmessage",on:{click:function(e){}}},[e._v("清空站点聊天记录")]),e._v(" "),t("div",{staticClass:"wap-main-friend-delete"},[t("Button",{attrs:{long:"",type:"error"},on:{click:e.Logout}},[e._v("退出站点")])],1)])]),e._v(" "),t("Modal",{attrs:{title:"修改群聊名称","class-name":"wap-my-modal"},on:{"on-cancel":function(n){e.update_nickname_modal=!1}},model:{value:e.update_nickname_modal,callback:function(n){e.update_nickname_modal=n},expression:"update_nickname_modal"}},[t("div",{staticClass:"wap-my-modal-text"},[t("Input",{attrs:{placeholder:"请输入新昵称",autofocus:""},model:{value:e.new_nickname,callback:function(n){e.new_nickname=n},expression:"new_nickname"}})],1),e._v(" "),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("Button",{attrs:{type:"text"},on:{click:function(n){e.update_nickname_modal=!1}}},[e._v("取消")]),e._v(" "),t("Button",{attrs:{type:"primary"},on:{click:e.updateUserNickname}},[e._v("确定")])],1)])],1)},staticRenderFns:[]};var l=t("VU/8")(i,u,!1,function(e){t("9srz")},null,null);n.default=l.exports}});
//# sourceMappingURL=6.e6b3465a1400c61bed64.js.map