webpackJsonp([10],{U1RV:function(e,t){},jyJz:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("Xxa5"),s=n.n(a),o=n("exGp"),i=n.n(o),c=n("gyMJ"),r={name:"User",mounted:function(){this.checkLogin()},data:function(){return{chatroom_active:!1,update_nickname_modal:!1,new_nickname:"",user:{}}},methods:{checkLogin:function(){var e=this;return i()(s.a.mark(function t(){var n;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(c.f)();case 2:n=t.sent,console.log(n),200===n.code&&(e.user=n.data);case 5:case"end":return t.stop()}},t,e)}))()},toChat:function(){this.$router.push("/")},toFriend:function(){this.$router.push("/friend")},toGroup:function(){this.$router.push("/group")},clickImage:function(){document.getElementById("send-image").click()},uploadImage:function(){var e=this;return i()(s.a.mark(function t(){var n,a,o,i;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=document.getElementById("send-image"),a=n.files[0],(o=new FormData).append("file",a),t.next=6,Object(c.w)(o);case 6:i=t.sent,console.log(i),200===i.code?(e.user.logo=e.$Server+i.data.url,console.log("上传头像成功",e.user.logo),e.updateUserLogo()):e.$Message.error(i.message);case 9:case"end":return t.stop()}},t,e)}))()},updateUserLogo:function(){var e=this;return i()(s.a.mark(function t(){var n,a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n={logo:e.user.logo},t.next=3,Object(c.u)(n);case 3:200===(a=t.sent).code?(console.log("更换头像成功",e.user),e.$User.setUser(e.user)):e.$Message.error(a.message);case 5:case"end":return t.stop()}},t,e)}))()},updateUserNickname:function(){var e=this;return i()(s.a.mark(function t(){var n,a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.new_nickname.trim()){t.next=3;break}return e.$Message.warning("用户昵称不能为空"),t.abrupt("return");case 3:return n={nickname:e.new_nickname},t.next=6,Object(c.u)(n);case 6:200===(a=t.sent).code?(e.user.nickname=e.new_nickname,e.$User.setUser(e.user),e.update_nickname_modal=!1):e.$Message.error(a.message);case 8:case"end":return t.stop()}},t,e)}))()},Logout:function(){var e=this;return i()(s.a.mark(function t(){var n;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(c.a)();case 2:n=t.sent,console.log(n),200===n.code?(e.$Message.success("用户退出登录成功"),e.$User.setUser(null),e.$router.push("/login")):e.$Message.warning("用户退出登录异常");case 5:case"end":return t.stop()}},t,e)}))()}},sockets:{connect:function(){console.log("socket connected")},message:function(){console.log("返回"+val)}},filters:{},watch:{}},u={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"send-image"},on:{change:e.uploadImage}}),e._v(" "),n("div",{staticClass:"wap-main"},[n("div",{staticClass:"wap-main-title"},[n("div",{staticClass:"text"},[e._v("\n        在线聊天室\n        "),e.user.type<2?n("Icon",{attrs:{type:"md-arrow-dropdown",size:"24"},on:{click:function(t){e.chatroom_active=!e.chatroom_active}}}):e._e(),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.chatroom_active,expression:"chatroom_active"}],staticClass:"wap-create-group-modal"},[n("ul",[n("li",{on:{click:function(t){e.$router.push("/group_add")}}},[e._v("创建群组")]),e._v(" "),n("li",{on:{click:function(t){e.$router.push("/friend_add")}}},[e._v("添加好友")])])])],1)]),e._v(" "),n("div",{staticClass:"wap-main-body",on:{click:function(t){e.chatroom_active=!1}}},[n("div",{staticClass:"wap-main-body-setting"},[n("div",{staticClass:"wap-main-friend-body"},[n("div",{staticClass:"wap-main-friend-logo"},[n("img",{attrs:{src:e.user.logo,alt:""}})]),e._v(" "),n("div",{staticClass:"wap-main-friend-info"},[n("p",{staticClass:"wap-main-friend-remark"},[e._v(e._s(e.user.username))]),e._v(" "),n("p",{staticClass:"wap-main-friend-nickname"},[e._v("昵称："+e._s(e.user.nickname)+" "),n("Icon",{attrs:{type:"md-create",alt:"修改昵称"},on:{click:function(t){e.update_nickname_modal=!0}}})],1),e._v(" "),n("Button",{staticStyle:{"margin-top":"10px"},attrs:{size:"small"},on:{click:e.clickImage}},[e._v("更换头像")])],1)]),e._v(" "),n("div",{staticClass:"wap-main-friend-bottom"},[n("div",{staticClass:"wap-main-friend-update-remark",on:{click:function(t){e.$router.push("/user_password")}}},[e._v("修改密码")]),e._v(" "),n("div",{staticClass:"wap-main-friend-sendmessage",on:{click:function(e){}}},[e._v("清空站点聊天记录")]),e._v(" "),n("div",{staticClass:"wap-main-friend-delete"},[n("Button",{attrs:{long:"",type:"error"},on:{click:e.Logout}},[e._v("退出站点")])],1)])])]),e._v(" "),n("div",{staticClass:"wap-main-bottom"},[n("ul",[n("li",{staticClass:"wap-main-bottom-chat",on:{click:e.toChat}},[n("div",[n("Icon",{attrs:{type:"ios-chatbubbles",size:"32"}})],1),e._v(" "),n("p",[e._v("聊天")])]),e._v(" "),n("li",{staticStyle:{width:"23%"},on:{click:e.toFriend}},[n("div",[n("Icon",{attrs:{type:"md-contacts",size:"32"}})],1),e._v(" "),n("p",[e._v("\n            好友\n          ")])]),e._v(" "),n("li",{staticStyle:{width:"23%"},on:{click:e.toGroup}},[n("div",[n("Icon",{attrs:{type:"ios-people",size:"34"}})],1),e._v(" "),n("p",[e._v("\n            群聊\n          ")])]),e._v(" "),n("li",{staticClass:"wap-main-bottom-my active"},[n("div",[n("Icon",{attrs:{type:"md-person",size:"32"}})],1),e._v(" "),n("p",[e._v("我")])])])])]),e._v(" "),n("Modal",{attrs:{title:"修改群聊名称","class-name":"wap-my-modal"},on:{"on-cancel":function(t){e.update_nickname_modal=!1}},model:{value:e.update_nickname_modal,callback:function(t){e.update_nickname_modal=t},expression:"update_nickname_modal"}},[n("div",{staticClass:"wap-my-modal-text"},[n("Input",{attrs:{placeholder:"请输入新昵称",autofocus:""},model:{value:e.new_nickname,callback:function(t){e.new_nickname=t},expression:"new_nickname"}})],1),e._v(" "),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{attrs:{type:"text"},on:{click:function(t){e.update_nickname_modal=!1}}},[e._v("取消")]),e._v(" "),n("Button",{attrs:{type:"primary"},on:{click:e.updateUserNickname}},[e._v("确定")])],1)])],1)},staticRenderFns:[]};var l=n("VU/8")(r,u,!1,function(e){n("U1RV")},null,null);t.default=l.exports}});
//# sourceMappingURL=10.5a421a780afd29015cc1.js.map