webpackJsonp([9],{M4iv:function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=e("Xxa5"),s=e.n(a),c=e("exGp"),n=e.n(c),o=e("gyMJ"),r={name:"Wap",mounted:function(){this.$User.user?(this.getChat(),this.in_chat_list()):this.$router.push("/login")},data:function(){return{chatroom_active:!1,chat_delete_modal:"",Loop:null,chat_list:[{id:1,name:"test",logo:"/static/images/admin.jpg",type:"group",chat_obj_id:1},{id:2,name:"xiaoxin",logo:"/static/images/xiaoxin.jpg",type:"friend",chat_obj_id:2}]}},methods:{toFriend:function(){this.$router.push("/friend")},toGroup:function(){this.$router.push("/group")},toUser:function(){this.$router.push("/user")},getChat:function(){var t=this;return n()(s.a.mark(function i(){var e;return s.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Object(o.l)();case 2:200===(e=i.sent).code?t.chat_list=e.data:t.$Message.error(e.message);case 4:case"end":return i.stop()}},i,t)}))()},touchStart:function(t){var i=this;this.Loop=setTimeout(function(){console.log("start.........",t),i.chat_delete_modal=t},500)},touchEnd:function(){clearTimeout(this.Loop)},delChat:function(t){var i=this;return n()(s.a.mark(function e(){var a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={chat_id:t.id},e.next=3,Object(o.h)(a);case 3:200===e.sent.code&&i.getChat();case 5:case"end":return e.stop()}},e,i)}))()},changeChat:function(t){this.$router.push({path:"/chat/",query:{id:t}})},in_chat_list:function(){this.$socket.emit("in_chat_list")},out_chat_list:function(){this.$socket.emit("out_chat_list")}},destroyed:function(){this.out_chat_list()},sockets:{connect:function(){console.log("socket connected")},message:function(t){console.log(t);var i=this.chat_list.filter(function(i){return i.id===t.id})[0];this.chat_list.pop(i),this.chat_list.unshift(t)}},filters:{}},u={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"wap-main"},[e("div",{staticClass:"wap-main-title"},[e("div",{staticClass:"text"},[t._v("\n      在线聊天室\n      "),t.$User.user.type<2?e("Icon",{attrs:{type:"md-arrow-dropdown",size:"24"},on:{click:function(i){t.chatroom_active=!t.chatroom_active}}}):t._e(),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.chatroom_active,expression:"chatroom_active"}],staticClass:"wap-create-group-modal"},[e("ul",[e("li",{on:{click:function(i){t.$router.push("/group_add")}}},[t._v("创建群组")]),t._v(" "),e("li",{on:{click:function(i){t.$router.push("/friend_add")}}},[t._v("添加好友")])])])],1)]),t._v(" "),e("div",{staticClass:"wap-main-body",on:{click:function(i){t.chatroom_active=t.chat_delete_modal=!1}}},[e("div",{staticClass:"wap-main-body-message"},[t._l(t.chat_list,function(i){return[e("div",{staticClass:"chat-item",on:{click:function(e){t.changeChat(i.id)},touchstart:function(e){t.touchStart(i.id)},touchend:t.touchEnd}},[e("div",{staticClass:"chat-img"},[e("img",{attrs:{src:i.logo}})]),t._v(" "),e("div",{staticClass:"chat-text"},[e("div",{staticClass:"chat-text-top"},[e("span",{staticClass:"chat-text-name"},[t._v(t._s(i.name))]),t._v(" "),e("span",{staticClass:"chat-text-time"},[t._v(t._s(i.update_time))])]),t._v(" "),e("div",{staticClass:"chat-text-message",domProps:{innerHTML:t._s(i.message)}})]),t._v(" "),t.chat_delete_modal===i.id?e("div",{staticClass:"chat-item-modal"},[e("p",{on:{click:function(e){t.delChat(i)}}},[t._v("删除该聊天")])]):t._e()])]})],2)]),t._v(" "),e("div",{staticClass:"wap-main-bottom"},[e("ul",[e("li",{staticClass:"wap-main-bottom-chat active"},[e("div",[e("Icon",{attrs:{type:"ios-chatbubbles",size:"32"}})],1),t._v(" "),e("p",[t._v("聊天")])]),t._v(" "),e("li",{staticStyle:{width:"23%"},on:{click:t.toFriend}},[e("div",[e("Icon",{attrs:{type:"md-contacts",size:"32"}})],1),t._v(" "),e("p",[t._v("\n          好友\n        ")])]),t._v(" "),e("li",{staticStyle:{width:"23%"},on:{click:t.toGroup}},[e("div",[e("Icon",{attrs:{type:"ios-people",size:"34"}})],1),t._v(" "),e("p",[t._v("\n          群聊\n        ")])]),t._v(" "),e("li",{staticClass:"wap-main-bottom-my",on:{click:t.toUser}},[e("div",[e("Icon",{attrs:{type:"md-person",size:"32"}})],1),t._v(" "),e("p",[t._v("我")])])])])])},staticRenderFns:[]};var l=e("VU/8")(r,u,!1,function(t){e("qQMG")},null,null);i.default=l.exports},qQMG:function(t,i){}});
//# sourceMappingURL=9.398d79c76f28c678df0b.js.map