webpackJsonp([20],{"+skl":function(t,e){},0:function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("7+uW"),a=n("Xxa5"),o=n.n(a),i=n("exGp"),c=n.n(i),s=n("gyMJ"),u={name:"Tab",created:function(){this.checkLogin()},mounted:function(){},data:function(){return{active:"chat",user:{},user_info:!1,change_nickname_modal:!1,change_password_modal:!1,new_nickname:"",new_password:"",new_password_re:"",send_image:null,setting_active:!1,chat_setting_show:null,del_friend_modal:!1,edit_remark_modal:!1,new_remark_name:""}},methods:{toMenu:function(t){this.active=t,this.$router.push("/pc/"+t)},checkLogin:function(){var t=this;return c()(o.a.mark(function e(){var n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(s.f)();case 2:n=e.sent,console.log(n),200===n.code?(t.$User.setUser(n.data),t.user=n.data):t.$Message.warning(n.message);case 5:case"end":return e.stop()}},e,t)}))()},clickImage:function(){document.getElementById("update-logo-image").click()},uploadImage:function(){var t=this;return c()(o.a.mark(function e(){var n,r,a,i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=document.getElementById("update-logo-image"),r=n.files[0],(a=new FormData).append("file",r),e.next=6,Object(s.y)(a);case 6:i=e.sent,console.log(i),200===i.code?(t.user.logo=t.$Server+i.data.url,console.log("上传头像成功",t.user.logo),t.updateUserLogo()):t.$Message.error(i.message);case 9:case"end":return e.stop()}},e,t)}))()},updateUserLogo:function(){var t=this;return c()(o.a.mark(function e(){var n,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={logo:t.user.logo},e.next=3,Object(s.w)(n);case 3:200===(r=e.sent).code?console.log("更换头像成功",t.user):t.$Message.error(r.message);case 5:case"end":return e.stop()}},e,t)}))()},updateUserNickname:function(){var t=this;return c()(o.a.mark(function e(){var n,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.new_nickname.trim()){e.next=3;break}return t.$Message.warning("用户昵称不能为空"),e.abrupt("return");case 3:return n={nickname:t.new_nickname},e.next=6,Object(s.w)(n);case 6:200===(r=e.sent).code?(t.user.nickname=t.new_nickname,t.change_nickname_modal=!1,t.$User.setUser(t.user)):t.$Message.error(r.message);case 8:case"end":return e.stop()}},e,t)}))()},updateUserPassword:function(){var t=this;return c()(o.a.mark(function e(){var n,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.new_password.trim()){e.next=3;break}return t.$Message.warning("密码不能为空"),e.abrupt("return");case 3:if(t.new_password.trim()===t.new_password_re.trim()){e.next=6;break}return t.$Message.warning("两次密码不一致"),e.abrupt("return");case 6:return n={password:t.new_password},e.next=9,Object(s.w)(n);case 9:200===(r=e.sent).code?(t.$Message.success("密码修改成功"),t.change_password_modal=!1,t.$router.go(-1)):t.$Message.error(r.message);case 11:case"end":return e.stop()}},e,t)}))()},Logout:function(){var t=this;return c()(o.a.mark(function e(){var n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(s.a)();case 2:n=e.sent,console.log(n),200===n.code?(t.$Message.success("用户退出登录成功"),t.$router.go(0)):t.$Message.warning("用户退出登录异常");case 5:case"end":return e.stop()}},e,t)}))()}},watch:{$route:function(){var t=this.$route.path;console.log("path:",t),this.active=t.split("/")[t.split("/").length-1]}}},d={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"left"}},[n("div",{staticClass:"user",on:{mouseleave:function(e){t.user_info=!1}}},[n("img",{attrs:{src:t.user.logo,alt:""},on:{click:t.clickImage,mouseover:function(e){t.user_info=!0}}}),t._v(" "),n("div",{staticClass:"user-text"},[t._v("\n      "+t._s(t.user.nickname)+"\n    ")]),t._v(" "),t.user_info?n("div",{staticClass:"user-info",on:{mouseleave:function(e){t.user_info=!1}}},[n("ul",[n("li",{on:{click:function(e){t.change_nickname_modal=!0}}},[t._v("更改昵称")]),t._v(" "),n("li",{on:{click:function(e){t.change_password_modal=!0}}},[t._v("更改密码")]),t._v(" "),n("li",{on:{click:t.Logout}},[t._v("退出登录")])])]):t._e()]),t._v(" "),n("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"update-logo-image"},on:{change:t.uploadImage}}),t._v(" "),n("ul",[n("li",{class:"menu-item "+("chat"===t.active?"active":""),on:{click:function(e){t.toMenu("chat")}}},[n("Tooltip",{attrs:{content:"消息",placement:"right-start"}},[n("div",{style:"width: "+("message"===t.active?"76px":"80px")},[n("Icon",{attrs:{type:"ios-chatbubbles",size:"30"}})],1)])],1),t._v(" "),n("li",{class:"menu-item "+("group"===t.active?"active":""),on:{click:function(e){t.toMenu("group")}}},[n("Tooltip",{attrs:{content:"群聊",placement:"right-start"}},[n("div",{style:"width: "+("chat"===t.active?"76px":"80px")},[n("Icon",{attrs:{type:"md-contacts",size:"30"}})],1)])],1),t._v(" "),n("li",{class:"menu-item "+("friend"===t.active?"active":""),on:{click:function(e){t.toMenu("friend")}}},[n("Tooltip",{attrs:{content:"好友",placement:"right-start"}},[n("div",{style:"width: "+("friend"===t.active?"76px":"80px")},[n("Icon",{attrs:{type:"md-person",size:"30"}})],1)])],1)]),t._v(" "),n("Modal",{attrs:{title:"修改昵称","class-name":"my-modal",width:"400px"},on:{"on-cancel":function(e){t.change_nickname_modal=!1}},model:{value:t.change_nickname_modal,callback:function(e){t.change_nickname_modal=e},expression:"change_nickname_modal"}},[n("div",{staticClass:"my-modal-input"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.new_nickname,expression:"new_nickname"}],attrs:{type:"text",placeholder:"请输入新昵称"},domProps:{value:t.new_nickname},on:{input:function(e){e.target.composing||(t.new_nickname=e.target.value)}}})]),t._v(" "),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{attrs:{type:"text",size:"large"},on:{click:function(e){t.change_nickname_modal=!1}}},[t._v("取消")]),t._v(" "),n("Button",{attrs:{type:"primary",size:"large"},on:{click:t.updateUserNickname}},[t._v("确定")])],1)]),t._v(" "),n("Modal",{attrs:{title:"修改密码","class-name":"my-modal",width:"400px"},on:{"on-cancel":function(e){t.change_password_modal=!1}},model:{value:t.change_password_modal,callback:function(e){t.change_password_modal=e},expression:"change_password_modal"}},[n("div",{staticClass:"my-modal-input"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.new_password,expression:"new_password"}],attrs:{type:"text",placeholder:"请输入新密码"},domProps:{value:t.new_password},on:{input:function(e){e.target.composing||(t.new_password=e.target.value)}}})]),t._v(" "),n("div",{staticClass:"my-modal-input"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.new_password_re,expression:"new_password_re"}],attrs:{type:"text",placeholder:"重复输入新密码"},domProps:{value:t.new_password_re},on:{input:function(e){e.target.composing||(t.new_password_re=e.target.value)}}})]),t._v(" "),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{attrs:{type:"text",size:"large"},on:{click:function(e){t.change_password_modal=!1}}},[t._v("取消")]),t._v(" "),n("Button",{attrs:{type:"primary",size:"large"},on:{click:t.updateUserPassword}},[t._v("确定")])],1)])],1)},staticRenderFns:[]};var p=n("VU/8")(u,d,!1,function(t){n("eWYk")},"data-v-2ec0c961",null).exports,l={name:"Tab",created:function(){this.checkLogin()},data:function(){return{active:"chat",user:{},chatroom_active:!1}},methods:{toChat:function(){this.$router.push("/wap"),this.active="chat"},toFriend:function(){this.$router.push("/friend"),this.active="friend"},toGroup:function(){this.$router.push("/group"),this.active="group"},toUser:function(){this.$router.push("/user"),this.active="user"},checkLogin:function(){var t=this;return c()(o.a.mark(function e(){var n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(s.f)();case 2:n=e.sent,console.log(n),200===n.code?(t.$User.setUser(n.data),t.user=n.data):t.$Message.warning(n.message);case 5:case"end":return e.stop()}},e,t)}))()}},watch:{$route:function(){var t=this.$route.path;console.log("path:",t),this.active=t.split("/")[t.split("/").length-1]}}},m={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"wap-main"},[n("div",{staticClass:"wap-main-title"},[n("div",{staticClass:"text"},[t._v("\n      在线聊天室\n      "),n("Icon",{attrs:{type:"md-arrow-dropdown",size:"24"},on:{click:function(e){t.chatroom_active=!t.chatroom_active}}}),t._v(" "),t.chatroom_active?n("div",{staticClass:"wap-create-group-modal"},[n("ul",[t.user&&t.user.type<2?n("li",{on:{click:function(e){t.$router.push("/group_add")}}},[t._v("创建群组")]):t._e(),t._v(" "),n("li",{on:{click:function(e){t.$router.push("/friend_add")}}},[t._v("添加好友")])])]):t._e()],1)]),t._v(" "),n("div",{staticClass:"wap-main-bottom"},[n("ul",[n("li",{class:"wap-main-bottom-chat "+("chat"===t.active?"active":""),on:{click:t.toChat}},[n("div",[n("Icon",{attrs:{type:"ios-chatbubbles",size:"32"}})],1),t._v(" "),n("p",[t._v("聊天")])]),t._v(" "),n("li",{class:"wap-main-bottom-chat "+("friend"===t.active?"active":""),staticStyle:{width:"23%"},on:{click:t.toFriend}},[n("div",[n("Icon",{attrs:{type:"md-contacts",size:"32"}})],1),t._v(" "),n("p",[t._v("\n          好友\n        ")])]),t._v(" "),n("li",{class:"wap-main-bottom-chat "+("group"===t.active?"active":""),staticStyle:{width:"23%"},on:{click:t.toGroup}},[n("div",[n("Icon",{attrs:{type:"ios-people",size:"34"}})],1),t._v(" "),n("p",[t._v("\n          群聊\n        ")])]),t._v(" "),n("li",{staticClass:"wap-main-bottom-my",class:"wap-main-bottom-chat "+("user"===t.active?"active":""),on:{click:t.toUser}},[n("div",[n("Icon",{attrs:{type:"md-person",size:"32"}})],1),t._v(" "),n("p",[t._v("我")])])])])])},staticRenderFns:[]};var f=n("VU/8")(l,m,!1,function(t){n("zlm2")},"data-v-b147f6f2",null).exports,h={props:{url:{required:!0}},data:function(){return{loading:!1,html:""}},watch:{url:function(t){this.load(t)}},mounted:function(){this.load()},methods:{load:function(){var t=this;return c()(o.a.mark(function e(){var n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(s.q)();case 2:n=e.sent,t.html=n.data;case 4:case"end":return e.stop()}},e,t)}))()}}},_={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"my-frame"},[e("iframe",{attrs:{src:"https://hello.yy.com/",width:"100%",height:"100%",frameborder:"0"}})])}]};var v={name:"App",data:function(){return{frame_show:!1,show:""}},created:function(){this.$socket.emit("in_chat"),document.body.clientWidth>500?this.show="pc":this.show="wap"},methods:{},mounted:function(){var t=this;window.addEventListener("beforeunload",function(e){return t.$socket.emit("out_chat")})},destroyed:function(){console.log("exit........."),this.$socket.emit("out_chat")},components:{pcTab:p,MyFrame:n("VU/8")(h,_,!1,function(t){n("qUOt")},null,null).exports,wapTab:f}},g={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view"),this._v(" "),"pc"===this.show?[e("pcTab")]:[e("wapTab")]],2)},staticRenderFns:[]};var w=n("VU/8")(v,g,!1,function(t){n("qJ/d")},null,null).exports,k=n("/ocq");r.default.use(k.a);var b=new k.a({routes:[{path:"/",redirect:document.body.clientWidth>500?"/pc/chat":"/wap"},{path:"/pc/chat",component:function(){return Promise.all([n.e(0),n.e(2)]).then(n.bind(null,"Tgbz"))},name:"pcChat"},{path:"/pc/group",component:function(){return n.e(5).then(n.bind(null,"5D29"))},name:"pcGroup"},{path:"/pc/friend",component:function(){return n.e(3).then(n.bind(null,"e58N"))},name:"pcFriend"},{path:"/home",component:function(){return Promise.all([n.e(0),n.e(1)]).then(n.bind(null,"Uerx"))},name:"Home"},{path:"/wap",component:function(){return n.e(17).then(n.bind(null,"/Pig"))},name:"Wap"},{path:"/user",component:function(){return n.e(6).then(n.bind(null,"PiJF"))},name:"User"},{path:"/user_password",component:function(){return n.e(8).then(n.bind(null,"t3T6"))},name:"UserPassword"},{path:"/chat/:id",component:function(){return Promise.all([n.e(0),n.e(14)]).then(n.bind(null,"L6FC"))},name:"Chat"},{path:"/friend",component:function(){return n.e(12).then(n.bind(null,"dhX8"))},name:"Friend"},{path:"/friend_info/:id",component:function(){return n.e(16).then(n.bind(null,"lncJ"))},name:"FriendInfo"},{path:"/friend_add",component:function(){return n.e(7).then(n.bind(null,"Tmzu"))},name:"FriendAdd"},{path:"/group",component:function(){return n.e(9).then(n.bind(null,"x6Z6"))},name:"Group"},{path:"/group_info/:id",component:function(){return n.e(4).then(n.bind(null,"bXtg"))},name:"GroupInfo"},{path:"/group_add",component:function(){return n.e(11).then(n.bind(null,"AXd7"))},name:"GroupAdd"},{path:"/group_user_add/:id",component:function(){return n.e(18).then(n.bind(null,"zrbn"))},name:"GroupUserAdd"},{path:"/group_user_del/:id",component:function(){return n.e(15).then(n.bind(null,"tVJf"))},name:"GroupUserDel"},{path:"/group_admin/:id",component:function(){return n.e(13).then(n.bind(null,"6hZk"))},name:"GroupAdmin"},{path:"/group_admin_add",component:function(){return n.e(10).then(n.bind(null,"O0Cf"))},name:"GroupAdminAdd"}]}),x=n("BTaQ"),y=n.n(x),$=(n("+skl"),n("Vpw6"),n("hMcO")),U=n.n($),M=n("DmT9"),C=n.n(M);r.default.use(y.a),r.default.use(U.a,C()("")),r.default.config.productionTip=!1,r.default.prototype.$Server="",r.default.prototype.$User={user:null,setUser:function(t){this.user=t}},new r.default({el:"#app",router:b,components:{App:w},template:"<App/>"})},Vpw6:function(t,e){},eWYk:function(t,e){},gyMJ:function(t,e,n){"use strict";n.d(e,"f",function(){return o}),n.d(e,"a",function(){return i}),n.d(e,"y",function(){return c}),n.d(e,"x",function(){return s}),n.d(e,"r",function(){return u}),n.d(e,"w",function(){return d}),n.d(e,"n",function(){return p}),n.d(e,"m",function(){return l}),n.d(e,"c",function(){return m}),n.d(e,"t",function(){return f}),n.d(e,"h",function(){return h}),n.d(e,"o",function(){return _}),n.d(e,"d",function(){return v}),n.d(e,"u",function(){return g}),n.d(e,"i",function(){return w}),n.d(e,"s",function(){return k}),n.d(e,"p",function(){return b}),n.d(e,"e",function(){return x}),n.d(e,"v",function(){return y}),n.d(e,"j",function(){return $}),n.d(e,"b",function(){return U}),n.d(e,"k",function(){return M}),n.d(e,"g",function(){return C}),n.d(e,"l",function(){return z}),n.d(e,"q",function(){return I});var r=n("mtWM"),a=n.n(r);a.a.interceptors.response.use(function(t){return t.data});var o=function(){return a.a.get("/check_login")},i=function(t){return a.a.post("/logout",t)},c=function(t){return a.a.post("/upload_logo",t)},s=function(t){return a.a.post("/upload_image",t)},u=function(t){return a.a.get("/user",{params:t})},d=function(t){return a.a.put("/user",t)},p=function(t){return a.a.get("/friend_info",{params:t})},l=function(){return a.a.get("/friend")},m=function(t){return a.a.post("/friend",t)},f=function(t){return a.a.put("/friend",t)},h=function(t){return a.a.delete("/friend",{params:t})},_=function(t){return a.a.get("/group",{params:t})},v=function(t){return a.a.post("/group",t)},g=function(t){return a.a.put("/group",t)},w=function(t){return a.a.delete("/group",{params:t})},k=function(t){return a.a.delete("/quit_group",{params:t})},b=function(t){return a.a.get("/group_user",{params:t})},x=function(t){return a.a.post("/group_user",t)},y=function(t){return a.a.put("/group_user",t)},$=function(t){return a.a.delete("/group_user",{params:t})},U=function(t){return a.a.post("/chat",t)},M=function(t){return a.a.get("/chat",{params:t})},C=function(t){return a.a.delete("/chat",{params:t})},z=function(t){return a.a.get("/chat_message",{params:t})},I=function(){return a.a.get("/get_html")}},"qJ/d":function(t,e){},qUOt:function(t,e){},zlm2:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.6539dc0752903c9a0f78.js.map