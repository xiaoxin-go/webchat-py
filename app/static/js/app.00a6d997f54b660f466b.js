webpackJsonp([20],{"+skl":function(e,t){},"/Mb9":function(e,t){},0:function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("7+uW"),a=n("Xxa5"),o=n.n(a),i=n("exGp"),c=n.n(i),s=n("gyMJ"),u={name:"Tab",created:function(){this.checkLogin()},mounted:function(){},data:function(){return{active:"chat",user:{},user_info:!1,change_nickname_modal:!1,change_password_modal:!1,new_nickname:"",new_password:"",new_password_re:"",send_image:null,setting_active:!1,chat_setting_show:null,del_friend_modal:!1,edit_remark_modal:!1,new_remark_name:""}},methods:{toMenu:function(e){this.active=e,this.$router.push("/pc/"+e)},checkLogin:function(){var e=this;return c()(o.a.mark(function t(){var n;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(s.f)();case 2:n=t.sent,console.log(n),200===n.code?(e.$User.setUser(n.data),e.user=n.data):e.$Message.warning(n.message);case 5:case"end":return t.stop()}},t,e)}))()},clickImage:function(){document.getElementById("update-logo-image").click()},uploadImage:function(){var e=this;return c()(o.a.mark(function t(){var n,r,a,i;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=document.getElementById("update-logo-image"),r=n.files[0],(a=new FormData).append("file",r),t.next=6,Object(s.y)(a);case 6:i=t.sent,console.log(i),200===i.code?(e.user.logo=e.$Server+i.data.url,console.log("上传头像成功",e.user.logo),e.updateUserLogo()):e.$Message.error(i.message);case 9:case"end":return t.stop()}},t,e)}))()},updateUserLogo:function(){var e=this;return c()(o.a.mark(function t(){var n,r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n={logo:e.user.logo},t.next=3,Object(s.w)(n);case 3:200===(r=t.sent).code?console.log("更换头像成功",e.user):e.$Message.error(r.message);case 5:case"end":return t.stop()}},t,e)}))()},updateUserNickname:function(){var e=this;return c()(o.a.mark(function t(){var n,r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.new_nickname.trim()){t.next=3;break}return e.$Message.warning("用户昵称不能为空"),t.abrupt("return");case 3:return n={nickname:e.new_nickname},t.next=6,Object(s.w)(n);case 6:200===(r=t.sent).code?(e.user.nickname=e.new_nickname,e.change_nickname_modal=!1,e.$User.setUser(e.user)):e.$Message.error(r.message);case 8:case"end":return t.stop()}},t,e)}))()},updateUserPassword:function(){var e=this;return c()(o.a.mark(function t(){var n,r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.new_password.trim()){t.next=3;break}return e.$Message.warning("密码不能为空"),t.abrupt("return");case 3:if(e.new_password.trim()===e.new_password_re.trim()){t.next=6;break}return e.$Message.warning("两次密码不一致"),t.abrupt("return");case 6:return n={password:e.new_password},t.next=9,Object(s.w)(n);case 9:200===(r=t.sent).code?(e.$Message.success("密码修改成功"),e.change_password_modal=!1,e.$router.go(-1)):e.$Message.error(r.message);case 11:case"end":return t.stop()}},t,e)}))()},Logout:function(){var e=this;return c()(o.a.mark(function t(){var n;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(s.a)();case 2:n=t.sent,console.log(n),200===n.code?(e.$Message.success("用户退出登录成功"),e.$router.go(0)):e.$Message.warning("用户退出登录异常");case 5:case"end":return t.stop()}},t,e)}))()}},watch:{$route:function(){var e=this.$route.path;console.log("path:",e),this.active=e.split("/")[e.split("/").length-1]}}},d={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"left"}},[n("div",{staticClass:"user",on:{mouseleave:function(t){e.user_info=!1}}},[n("img",{attrs:{src:e.user.logo,alt:""},on:{click:e.clickImage,mouseover:function(t){e.user_info=!0}}}),e._v(" "),n("div",{staticClass:"user-text"},[e._v("\n      "+e._s(e.user.nickname)+"\n    ")]),e._v(" "),e.user_info?n("div",{staticClass:"user-info",on:{mouseleave:function(t){e.user_info=!1}}},[n("ul",[n("li",{on:{click:function(t){e.change_nickname_modal=!0}}},[e._v("更改昵称")]),e._v(" "),n("li",{on:{click:function(t){e.change_password_modal=!0}}},[e._v("更改密码")]),e._v(" "),n("li",{on:{click:e.Logout}},[e._v("退出登录")])])]):e._e()]),e._v(" "),n("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"update-logo-image"},on:{change:e.uploadImage}}),e._v(" "),n("ul",[n("li",{class:"menu-item "+("chat"===e.active?"active":""),on:{click:function(t){e.toMenu("chat")}}},[n("Tooltip",{attrs:{content:"消息",placement:"right-start"}},[n("div",{style:"width: "+("message"===e.active?"76px":"80px")},[n("Icon",{attrs:{type:"ios-chatbubbles",size:"30"}})],1)])],1),e._v(" "),n("li",{class:"menu-item "+("group"===e.active?"active":""),on:{click:function(t){e.toMenu("group")}}},[n("Tooltip",{attrs:{content:"群聊",placement:"right-start"}},[n("div",{style:"width: "+("chat"===e.active?"76px":"80px")},[n("Icon",{attrs:{type:"md-contacts",size:"30"}})],1)])],1),e._v(" "),n("li",{class:"menu-item "+("friend"===e.active?"active":""),on:{click:function(t){e.toMenu("friend")}}},[n("Tooltip",{attrs:{content:"好友",placement:"right-start"}},[n("div",{style:"width: "+("friend"===e.active?"76px":"80px")},[n("Icon",{attrs:{type:"md-person",size:"30"}})],1)])],1)]),e._v(" "),n("Modal",{attrs:{title:"修改昵称","class-name":"my-modal",width:"400px"},on:{"on-cancel":function(t){e.change_nickname_modal=!1}},model:{value:e.change_nickname_modal,callback:function(t){e.change_nickname_modal=t},expression:"change_nickname_modal"}},[n("div",{staticClass:"my-modal-input"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.new_nickname,expression:"new_nickname"}],attrs:{type:"text",placeholder:"请输入新昵称"},domProps:{value:e.new_nickname},on:{input:function(t){t.target.composing||(e.new_nickname=t.target.value)}}})]),e._v(" "),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{attrs:{type:"text",size:"large"},on:{click:function(t){e.change_nickname_modal=!1}}},[e._v("取消")]),e._v(" "),n("Button",{attrs:{type:"primary",size:"large"},on:{click:e.updateUserNickname}},[e._v("确定")])],1)]),e._v(" "),n("Modal",{attrs:{title:"修改密码","class-name":"my-modal",width:"400px"},on:{"on-cancel":function(t){e.change_password_modal=!1}},model:{value:e.change_password_modal,callback:function(t){e.change_password_modal=t},expression:"change_password_modal"}},[n("div",{staticClass:"my-modal-input"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.new_password,expression:"new_password"}],attrs:{type:"text",placeholder:"请输入新密码"},domProps:{value:e.new_password},on:{input:function(t){t.target.composing||(e.new_password=t.target.value)}}})]),e._v(" "),n("div",{staticClass:"my-modal-input"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.new_password_re,expression:"new_password_re"}],attrs:{type:"text",placeholder:"重复输入新密码"},domProps:{value:e.new_password_re},on:{input:function(t){t.target.composing||(e.new_password_re=t.target.value)}}})]),e._v(" "),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{attrs:{type:"text",size:"large"},on:{click:function(t){e.change_password_modal=!1}}},[e._v("取消")]),e._v(" "),n("Button",{attrs:{type:"primary",size:"large"},on:{click:e.updateUserPassword}},[e._v("确定")])],1)])],1)},staticRenderFns:[]};var p=n("VU/8")(u,d,!1,function(e){n("eWYk")},"data-v-2ec0c961",null).exports,l={name:"Tab",created:function(){this.checkLogin()},data:function(){return{active:"wap",user:{},chatroom_active:!1}},methods:{toChat:function(){this.$router.push("/wap"),this.active="wap"},toFriend:function(){this.$router.push("/friend"),this.active="friend"},toGroup:function(){this.$router.push("/group"),this.active="group"},toUser:function(){this.$router.push("/user"),this.active="user"},createGroup:function(){this.chatroom_active=!1,this.$router.push("/group_add")},addFriend:function(){this.chatroom_active=!1,this.$router.push("/friend_add")},checkLogin:function(){var e=this;return c()(o.a.mark(function t(){var n;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(s.f)();case 2:n=t.sent,console.log(n),200===n.code?(e.$User.setUser(n.data),e.user=n.data):e.$Message.warning(n.message);case 5:case"end":return t.stop()}},t,e)}))()}},watch:{$route:function(){var e=this.$route.path;console.log("path:",e),this.active=e.split("/")[1]}}},m={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"wap-main"},[n("div",{staticClass:"wap-main-title"},[n("div",{staticClass:"text"},[e._v("\n      在线聊天室\n      "),n("Icon",{attrs:{type:"md-arrow-dropdown",size:"24"},on:{click:function(t){e.chatroom_active=!e.chatroom_active}}}),e._v(" "),e.chatroom_active?n("div",{staticClass:"wap-create-group-modal"},[n("ul",[e.user&&e.user.type<2?n("li",{on:{click:e.createGroup}},[e._v("创建群组")]):e._e(),e._v(" "),n("li",{on:{click:e.addFriend}},[e._v("添加好友")])])]):e._e()],1)]),e._v(" "),n("div",{staticClass:"wap-main-bottom"},[n("ul",[n("li",{class:"wap"===e.active?"active":"",on:{click:e.toChat}},[n("div"),e._v(" "),n("div",[n("Icon",{attrs:{type:"ios-chatbubbles",size:"32"}})],1),e._v(" "),n("p",[e._v("聊天")])]),e._v(" "),n("li",{class:"friend"===e.active?"active":"",on:{click:e.toFriend}},[n("div",[n("Icon",{attrs:{type:"md-contacts",size:"32"}})],1),e._v(" "),n("p",[e._v("\n          好友\n        ")])]),e._v(" "),n("li",{class:"group"===e.active?"active":"",on:{click:e.toGroup}},[n("div",[n("Icon",{attrs:{type:"ios-people",size:"34"}})],1),e._v(" "),n("p",[e._v("\n          群聊\n        ")])]),e._v(" "),n("li",{class:"user"===e.active?"active":"",on:{click:e.toUser}},[n("div",[n("Icon",{attrs:{type:"md-person",size:"32"}})],1),e._v(" "),n("p",[e._v("我")])])])])])},staticRenderFns:[]};var f=n("VU/8")(l,m,!1,function(e){n("/Mb9")},"data-v-7e6b1ae6",null).exports,h={props:{url:{required:!0}},data:function(){return{loading:!1,html:""}},watch:{url:function(e){this.load(e)}},mounted:function(){this.load()},methods:{load:function(){var e=this;return c()(o.a.mark(function t(){var n;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(s.q)();case 2:n=t.sent,e.html=n.data;case 4:case"end":return t.stop()}},t,e)}))()}}},_={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"my-frame"},[t("iframe",{attrs:{src:"https://hello.yy.com/",width:"100%",height:"100%",frameborder:"0"}})])}]};var v={name:"App",data:function(){return{frame_show:!1,show:""}},created:function(){this.$socket.emit("in_chat"),document.body.clientWidth>500?this.show="pc":this.show="wap"},methods:{},mounted:function(){var e=this;window.addEventListener("beforeunload",function(t){return e.$socket.emit("out_chat")})},destroyed:function(){console.log("exit........."),this.$socket.emit("out_chat")},components:{pcTab:p,MyFrame:n("VU/8")(h,_,!1,function(e){n("qUOt")},null,null).exports,wapTab:f}},g={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view"),this._v(" "),"pc"===this.show?[t("pcTab")]:[t("wapTab")]],2)},staticRenderFns:[]};var w=n("VU/8")(v,g,!1,function(e){n("qJ/d")},null,null).exports,k=n("/ocq");r.default.use(k.a);var b=new k.a({routes:[{path:"/",redirect:document.body.clientWidth>500?"/pc/chat":"/wap"},{path:"/pc/chat",component:function(){return Promise.all([n.e(0),n.e(2)]).then(n.bind(null,"Tgbz"))},name:"pcChat"},{path:"/pc/group",component:function(){return n.e(5).then(n.bind(null,"5D29"))},name:"pcGroup"},{path:"/pc/friend",component:function(){return n.e(3).then(n.bind(null,"e58N"))},name:"pcFriend"},{path:"/home",component:function(){return Promise.all([n.e(0),n.e(1)]).then(n.bind(null,"Uerx"))},name:"Home"},{path:"/wap",component:function(){return n.e(17).then(n.bind(null,"/Pig"))},name:"Wap"},{path:"/user",component:function(){return n.e(6).then(n.bind(null,"PiJF"))},name:"User"},{path:"/user_password",component:function(){return n.e(7).then(n.bind(null,"t3T6"))},name:"UserPassword"},{path:"/chat/:id",component:function(){return Promise.all([n.e(0),n.e(14)]).then(n.bind(null,"L6FC"))},name:"Chat"},{path:"/friend",component:function(){return n.e(12).then(n.bind(null,"dhX8"))},name:"Friend"},{path:"/friend_info/:id",component:function(){return n.e(16).then(n.bind(null,"lncJ"))},name:"FriendInfo"},{path:"/friend_add",component:function(){return n.e(10).then(n.bind(null,"Tmzu"))},name:"FriendAdd"},{path:"/group",component:function(){return n.e(8).then(n.bind(null,"x6Z6"))},name:"Group"},{path:"/group_info/:id",component:function(){return n.e(4).then(n.bind(null,"bXtg"))},name:"GroupInfo"},{path:"/group_add",component:function(){return n.e(11).then(n.bind(null,"AXd7"))},name:"GroupAdd"},{path:"/group_user_add/:id",component:function(){return n.e(18).then(n.bind(null,"zrbn"))},name:"GroupUserAdd"},{path:"/group_user_del/:id",component:function(){return n.e(15).then(n.bind(null,"tVJf"))},name:"GroupUserDel"},{path:"/group_admin/:id",component:function(){return n.e(13).then(n.bind(null,"6hZk"))},name:"GroupAdmin"},{path:"/group_admin_add",component:function(){return n.e(9).then(n.bind(null,"O0Cf"))},name:"GroupAdminAdd"}]}),x=n("BTaQ"),y=n.n(x),$=(n("+skl"),n("Vpw6"),n("hMcO")),U=n.n($),M=n("DmT9"),C=n.n(M);r.default.use(y.a),r.default.use(U.a,C()("")),r.default.config.productionTip=!1,r.default.prototype.$Server="",r.default.prototype.$User={user:null,setUser:function(e){this.user=e}},new r.default({el:"#app",router:b,components:{App:w},template:"<App/>"})},Vpw6:function(e,t){},eWYk:function(e,t){},gyMJ:function(e,t,n){"use strict";n.d(t,"f",function(){return o}),n.d(t,"a",function(){return i}),n.d(t,"y",function(){return c}),n.d(t,"x",function(){return s}),n.d(t,"r",function(){return u}),n.d(t,"w",function(){return d}),n.d(t,"n",function(){return p}),n.d(t,"m",function(){return l}),n.d(t,"c",function(){return m}),n.d(t,"t",function(){return f}),n.d(t,"h",function(){return h}),n.d(t,"o",function(){return _}),n.d(t,"d",function(){return v}),n.d(t,"u",function(){return g}),n.d(t,"i",function(){return w}),n.d(t,"s",function(){return k}),n.d(t,"p",function(){return b}),n.d(t,"e",function(){return x}),n.d(t,"v",function(){return y}),n.d(t,"j",function(){return $}),n.d(t,"b",function(){return U}),n.d(t,"k",function(){return M}),n.d(t,"g",function(){return C}),n.d(t,"l",function(){return F}),n.d(t,"q",function(){return I});var r=n("mtWM"),a=n.n(r);a.a.interceptors.response.use(function(e){return e.data});var o=function(){return a.a.get("/check_login")},i=function(e){return a.a.post("/logout",e)},c=function(e){return a.a.post("/upload_logo",e)},s=function(e){return a.a.post("/upload_image",e)},u=function(e){return a.a.get("/user",{params:e})},d=function(e){return a.a.put("/user",e)},p=function(e){return a.a.get("/friend_info",{params:e})},l=function(){return a.a.get("/friend")},m=function(e){return a.a.post("/friend",e)},f=function(e){return a.a.put("/friend",e)},h=function(e){return a.a.delete("/friend",{params:e})},_=function(e){return a.a.get("/group",{params:e})},v=function(e){return a.a.post("/group",e)},g=function(e){return a.a.put("/group",e)},w=function(e){return a.a.delete("/group",{params:e})},k=function(e){return a.a.delete("/quit_group",{params:e})},b=function(e){return a.a.get("/group_user",{params:e})},x=function(e){return a.a.post("/group_user",e)},y=function(e){return a.a.put("/group_user",e)},$=function(e){return a.a.delete("/group_user",{params:e})},U=function(e){return a.a.post("/chat",e)},M=function(e){return a.a.get("/chat",{params:e})},C=function(e){return a.a.delete("/chat",{params:e})},F=function(e){return a.a.get("/chat_message",{params:e})},I=function(){return a.a.get("/get_html")}},"qJ/d":function(e,t){},qUOt:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.00a6d997f54b660f466b.js.map